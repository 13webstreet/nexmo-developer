<ul class="table-list">
  <li class="table-list-header">
    <div class="table-list-columns">
      <div class="table-list-column" flex="2">Key</div>
      <div class="table-list-column">Type</div>
      <div class="table-list-column" flex="3">Description</div>
      <% unless defined? model && model %>
        <div class="table-list-column">Example</div>
        <div class="table-list-column">Default</div>
        <div class="table-list-column">Required</div>
      <% end %>
    </div>
  </li>
  <% parameters.each do |parameter| %>
    <li>
      <div class="table-list-columns">
        <div class="table-list-column" flex="2">
          <code><%= parameter['name'] %></code>
        </div>

        <div class="table-list-column">
          <code><%= (parameter['type'] || parameter['schema']['type']) %></code>

          <% if parameter['type'] == 'array' %>
            <br>
            <% if parameter['items'] && parameter['items']['type'] %>
              <small><i>of <code><%= (parameter['items']['type']) %></code>'s</i></small>
            <% end %>
          <% end %>
        </div>

        <div class="table-list-column" flex="3">
          <% if ['object', 'array'].include?(parameter['type']) && parameter['items'] %>
            <!-- Do not render a description when the parameter is an object or array and has items defined -->
          <% else %>
            <%= (parameter['description'] ? "<b>#{parameter['description']}</b>" : '<i>None</i>').html_safe %>
          <% end %>

          <% if parameter['enum'] %>
            <br>
            <small>
              <i>
                Must be one of:
                <%= parameter['enum'].map { |s| "<code>#{s}</code>" }.to_sentence(last_word_connector: 'or', two_words_connector: 'or').html_safe %>
              </i>
            </small>
          <% end %>
        </div>

        <% unless defined? model && model %>
          <div class="table-list-column">
            <%= (parameter['example'] ? "<code>#{parameter['example']}</code>" : '<i>None</i>').html_safe %>
          </div>

          <div class="table-list-column">
            <%= (parameter['default'] ? "<code>#{parameter['default']}</code>" : '<i>None</i>').html_safe %>
          </div>

          <div class="table-list-column">
            <div class="center">
              <%=
                parameter['required'] ?
                '<i class="icon icon--large icon-check-circle color--success"></i>'.html_safe
                : '<i class="icon icon--large icon-times-circle color--error"></i>'.html_safe
              %>
            </div>
          </div>
        <% end %>
      </div>

      <% if ['array', 'object'].include? parameter['type']  %>
        <% if parameter['items'] %>
          <%= render 'parameters', parameters: OpenApi::EndpointResolver.normalize_properties(parameter['items']['properties']) %>
        <% end %>
      <% end %>
    </li>
  <% end %>
</ul>
